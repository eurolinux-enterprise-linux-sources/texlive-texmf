\documentclass{ppex}
\nonstopmode
\usepackage [matrix,arrow,frame,dvips]{xy}
\pagestyle{empty}

\begin{document}
\ResetPreambleCommands
\ReadyForTheFray
\usepackage [matrix,arrow,frame,dvips]{xy}
\newcommand{\topbar}{\vrule height 0.4pt width 20mm}
\newcommand{\previous}{% turning-width of 15mm
  \save\ar`r[u]+/r15mm/`[u][u]\restore }
\newcommand{\saved}[2]{\relax\txt{#1\\\emph{saved} $d[#2]$\\}}
\newcommand{\bendto}[2]{% creates a bendy arrow, offset 5mm
  \save c!C+/r5mm/\ar `r#1!C+/l#2/ `^r#1!C #1!C\restore}
\newcommand{\dinput}[1]{% label-offset 11mm
  \save +/l11mm/*{d[#1]}\restore}
\[\begin{xy}
\xymatrix"R" @M=0mm @H=12mm @W=20mm @R=0mm @*[F] {%
 {\txt{\topbar\\s\\\\ }}  %1,1
\\ \saved{A}{2}           %2,1
\\ \saved{B}{2}\previous  %3,1
\\ \saved{C}{3}           %4,1
}\turnradius{2mm}\POS(-30,+4)
\xymatrix @M=0mm @H=5mm @W=12mm @R=0mm @*[F] {%
   \dinput{1}\bendto{"R1,1"}{15mm}  %1,1
\\ \dinput{2}\bendto{"R3,1"}{17mm}  %2,1
\\ \dinput{3}\bendto{"R4,1"}{19mm}  %3,1
}
\end{xy}\]
\end{document}
